set -g mouse on

# enable status bar
set -g status on

# window number is started from 1
set -g base-index 1

set -g history-limit 50000

setw -g mode-keys vi

# ============================================
# 選択中のウィンドウ/ペインの視認性向上設定
# ============================================

# アクティブなウィンドウのタブスタイル（緑背景+黒文字+太字）
setw -g window-status-current-style fg=black,bg=green,bold

# アクティブでないウィンドウのタブスタイル
setw -g window-status-style fg=white,bg=black

# アクティブなペインのボーダー（緑）
set -g pane-active-border-style fg=green,bg=default

# アクティブでないペインのボーダー（グレー）
set -g pane-border-style fg=colour240,bg=default

# ステータスバーのスタイル
set -g status-style fg=white,bg=black

# アクティブなウィンドウのタブフォーマット
setw -g window-status-current-format ' #I:#W '

# アクティブでないウィンドウのタブフォーマット
setw -g window-status-format ' #I:#W '

# 256色サポート
set -g default-terminal "screen-256color"

# True Colorサポート
set -ga terminal-overrides ",xterm-256color:Tc"

# ============================================
# おすすめ追加設定
# ============================================


# ペインサイズ変更（Alt+方向キー）
bind -n M-Left resize-pane -L 5
bind -n M-Right resize-pane -R 5
bind -n M-Up resize-pane -U 5
bind -n M-Down resize-pane -D 5

# ウィンドウ移動をShift+矢印で
bind -n S-Left previous-window
bind -n S-Right next-window

# --- コピーモード（Vi風） ---
# コピー開始: prefix + [
# 選択開始: Space
# コピー: Enter
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel

# --- ステータスバー強化 ---
# 右側にGitブランチと日時を表示
set -g status-right '#[fg=cyan]#(cd #{pane_current_path}; git branch --show-current 2>/dev/null || echo "no git") #[fg=green]%Y-%m-%d %H:%M#[default]'

# ウィンドウ名を自動更新
setw -g automatic-rename on

# --- その他便利設定 ---
# ペイン番号も1から開始
setw -g pane-base-index 1

# ウィンドウを閉じた時に番号を詰める
set -g renumber-windows on

# エスケープキーの遅延を減らす（Vimユーザー向け）
set -sg escape-time 10

# フォーカスイベントを有効化（Vimとの連携）
set -g focus-events on

# アクティビティ監視（他のウィンドウで変化があったら通知）
setw -g monitor-activity on
set -g visual-activity off

# ベル無効化
set -g bell-action none

# マウスドラッグでコピー後に選択解除しない
unbind -T copy-mode-vi MouseDragEnd1Pane

# ============================================
# クリップボード連携
# ============================================

# Linux (xclip/xsel が必要)
# 選択したテキストをシステムクリップボードにコピー
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xclip -in -selection clipboard"
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -in -selection clipboard"

# WSL (Windows側のクリップボードと連携)
# bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "clip.exe"
# bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "clip.exe"

# macOS (pbcopy が必要)
# bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
# bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"

# ペースト: prefix + p
bind p paste-buffer
